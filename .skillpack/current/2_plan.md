# Phase 2: è¯¦ç»†å®æ–½è§„åˆ’ (æ›´æ–°)

## ç›®æ ‡: è®¢å•æäº¤æµç¨‹å®Œå–„

> å‰ç½®å·²å®Œæˆ: REST API, WebSocket, å‰ç«¯é…ç½®
> æœ¬è½®ç›®æ ‡: **ç”¨æˆ·èƒ½å¤Ÿè¿æ¥é’±åŒ…å¹¶æäº¤è®¢å•**

---

## å­ä»»åŠ¡æ¸…å•

### å­ä»»åŠ¡ 1: WalletButton ç»„ä»¶ â±ï¸ ~30åˆ†é’Ÿ

**åˆ›å»ºæ–‡ä»¶**:
```
frontend/src/components/WalletButton.tsx
```

**åŠŸèƒ½**:
- æ˜¾ç¤ºè¿æ¥/æ–­å¼€æŒ‰é’®
- æ˜¾ç¤ºç¼©çŸ­çš„é’±åŒ…åœ°å€
- æ˜¾ç¤ºè¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨
- é›†æˆåˆ°é¡µé¢é¡¶éƒ¨

**UI è®¾è®¡**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœªè¿æ¥:  [Connect Wallet]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å·²è¿æ¥:  ğŸŸ¢ perp1...xyz [â–¼] â”‚
â”‚          â””â”€ Disconnect      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å­ä»»åŠ¡ 2: Mock é’±åŒ…æ¨¡å¼ â±ï¸ ~45åˆ†é’Ÿ

**åˆ›å»ºæ–‡ä»¶**:
```
frontend/src/lib/wallet/mock.ts
```

**ä¿®æ”¹æ–‡ä»¶**:
- `frontend/src/hooks/useWallet.ts` - æ·»åŠ  mock æ¨¡å¼åˆ¤æ–­

**åŠŸèƒ½**:
- æ£€æµ‹ `NEXT_PUBLIC_MOCK_MODE=true`
- Mock æ¨¡å¼ä¸‹ä¸è¿æ¥çœŸå® Keplr
- æ¨¡æ‹Ÿé’±åŒ…åœ°å€å’Œç­¾å
- æ¨¡æ‹Ÿäº¤æ˜“å¹¿æ’­ (è¿”å›å‡ TxHash)

**Mock é’±åŒ…æ¥å£**:
```typescript
class MockWallet implements IWallet {
  async connect(): Promise<WalletAccount> {
    return {
      address: 'perpdex1mock...demo',
      pubKey: new Uint8Array(32),
      algo: 'secp256k1',
      name: 'Demo Account',
    };
  }

  async signAndBroadcast(messages, memo): Promise<BroadcastResult> {
    // æ¨¡æ‹Ÿ 2 ç§’å»¶è¿Ÿ
    await sleep(2000);
    return {
      code: 0,
      transactionHash: generateMockTxHash(),
      rawLog: 'Mock transaction succeeded',
    };
  }
}
```

---

### å­ä»»åŠ¡ 3: Toast é€šçŸ¥ç³»ç»Ÿ â±ï¸ ~30åˆ†é’Ÿ

**åˆ›å»ºæ–‡ä»¶**:
```
frontend/src/components/Toast.tsx
frontend/src/contexts/ToastContext.tsx
```

**åŠŸèƒ½**:
- å…¨å±€ Toast æä¾›è€…
- æ”¯æŒ success/error/info/warning ç±»å‹
- è‡ªåŠ¨æ¶ˆå¤± (5ç§’)
- å¯æ‰‹åŠ¨å…³é—­
- æ”¯æŒå¤šä¸ª Toast å †å 

**API è®¾è®¡**:
```typescript
const { showToast } = useToast();

// ä½¿ç”¨
showToast({
  type: 'success',
  title: 'è®¢å•å·²æäº¤',
  message: 'TxHash: 0x1234...5678',
});
```

---

### å­ä»»åŠ¡ 4: é“¾é…ç½®åŒæ­¥ â±ï¸ ~15åˆ†é’Ÿ

**éªŒè¯æ–‡ä»¶**:
- `frontend/.env.local`
- `frontend/src/lib/wallet/keplr.ts` (PERPDEX_CHAIN_CONFIG)
- `frontend/src/lib/config.ts`

**ç¡®ä¿ä¸€è‡´**:
```
chainId: perpdex-local-1
rpcUrl: http://localhost:26657
restUrl: http://localhost:1317
wsUrl: ws://localhost:8080/ws
```

---

### å­ä»»åŠ¡ 5: é”™è¯¯å¤„ç†å¢å¼º â±ï¸ ~30åˆ†é’Ÿ

**ä¿®æ”¹æ–‡ä»¶**:
- `frontend/src/hooks/useWallet.ts`
- `frontend/src/components/TradeForm.tsx`

**é”™è¯¯åˆ†ç±»**:
| é”™è¯¯ç±»å‹ | ç”¨æˆ·æç¤º |
|----------|----------|
| æœªå®‰è£… Keplr | "è¯·å®‰è£… Keplr é’±åŒ…æ‰©å±•" |
| ç”¨æˆ·æ‹’ç»è¿æ¥ | "å·²å–æ¶ˆé’±åŒ…è¿æ¥" |
| ç­¾åè¢«æ‹’ç» | "äº¤æ˜“å·²å–æ¶ˆ" |
| ç½‘ç»œé”™è¯¯ | "ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·é‡è¯•" |
| RPC è¶…æ—¶ | "äº¤æ˜“è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ" |
| ä½™é¢ä¸è¶³ | "ä¿è¯é‡‘ä¸è¶³" |

---

## æ‰§è¡Œé¡ºåº

```
[1] å­ä»»åŠ¡ 3: Toast é€šçŸ¥ (å…¶ä»–ç»„ä»¶ä¾èµ–)
     â”‚
     â–¼
[2] å­ä»»åŠ¡ 2: Mock é’±åŒ…æ¨¡å¼
     â”‚
     â–¼
[3] å­ä»»åŠ¡ 1: WalletButton ç»„ä»¶
     â”‚
     â–¼
[4] å­ä»»åŠ¡ 4: é“¾é…ç½®åŒæ­¥
     â”‚
     â–¼
[5] å­ä»»åŠ¡ 5: é”™è¯¯å¤„ç†å¢å¼º
     â”‚
     â–¼
[âœ“] è®¢å•æäº¤æµç¨‹å®Œæˆ
```

---

## é¢„è®¡æ—¶é—´

| å­ä»»åŠ¡ | æ—¶é—´ |
|--------|------|
| Toast é€šçŸ¥ç³»ç»Ÿ | 30 åˆ†é’Ÿ |
| Mock é’±åŒ…æ¨¡å¼ | 45 åˆ†é’Ÿ |
| WalletButton ç»„ä»¶ | 30 åˆ†é’Ÿ |
| é“¾é…ç½®åŒæ­¥ | 15 åˆ†é’Ÿ |
| é”™è¯¯å¤„ç†å¢å¼º | 30 åˆ†é’Ÿ |
| **æ€»è®¡** | **~2.5 å°æ—¶** |

---

## éªŒæ”¶æ ‡å‡†

1. âœ… é¡µé¢é¡¶éƒ¨æ˜¾ç¤º "Connect Wallet" æŒ‰é’®
2. âœ… Mock æ¨¡å¼ä¸‹ç‚¹å‡»è¿æ¥ï¼Œæ˜¾ç¤ºæ¨¡æ‹Ÿåœ°å€
3. âœ… å¡«å†™è®¢å•åç‚¹å‡»æäº¤ï¼Œæ˜¾ç¤ºç¡®è®¤å¼¹çª—
4. âœ… ç¡®è®¤åæ˜¾ç¤ºç­¾åä¸­çŠ¶æ€
5. âœ… äº¤æ˜“å®Œæˆåæ˜¾ç¤º Toast é€šçŸ¥
6. âœ… é”™è¯¯æƒ…å†µæ˜¾ç¤ºå‹å¥½æç¤º
